<html>

	<head>

		<meta charset="utf-8">
		<style>
			#tmImg {
				float: left;
				border: #2C3E50 1px dashed;
			}
		</style>
		<script type="text/javascript">
			function $(id) {
				return document.getElementById(id);
			}

			function textToImg() {
				var len = document.getElementById("name").value.length;
				var i = 0;
				var fontSize = 100;
				var fontWeight = 'bold';
				var txt = $("name").value;
				var canvas = $('canvas');
				if(txt == '') {
					alert('请输入文字！');
					$("name").focus();
				}
				if(len > txt.length) {
					len = txt.length;
				}
				canvas.width = 200;
				canvas.height = 200;
				var context = canvas.getContext('2d');
				context.clearRect(0, 0, canvas.width, canvas.height);
				//渐变
				var gradient = context.createLinearGradient(0, 0, canvas.width, 0);
				gradient.addColorStop("0", "magenta");
				gradient.addColorStop("0.5", "blue");
				gradient.addColorStop("1.0", "red");
				context.fillStyle = gradient;
				context.font = fontWeight + ' ' + fontSize + 'px 行书';
				context.textBaseline = 'top';
				canvas.style.display = 'none';
				//console.log(txt.length);

				function fillTxt(text) {
					context.textAlign = "center";
					context.fillText(text, 100, (200 - fontSize) / 4, canvas.width);
				}
				fillTxt(txt);
				var imageData = context.getImageData(0, 0, canvas.width, canvas.height);
				var img = $("tmImg");
				var urls = canvas.toDataURL("image/png");
				img.style.width = 200 + 'px';
				img.style.height = 200 + 'px';
				img.style.background = 'url(' + urls + ')'
			}
		</script>
	</head>

	<body>
		<div style="float: left"><input id="name" value="凉凉月色"></div>
		<div style="width: 200px; height: 100px; float: left; clear: right">
			<table>
				<tr>
					<td>
						<button onclick=textToImg();;>生成图片</button>
					</td>
				</tr>
			</table>
		</div>
		<canvas id="canvas" style="display:block"></canvas>
		<div id="tmImg"></div>
	</body>

</html>